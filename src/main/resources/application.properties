# ============================================
# CONFIGURACIÓN PROCESADOR PDI
# ============================================

# Puerto de la aplicación
server.port=${PORT:8080}

# ============================================
# POSTGRESQL DATABASE
# ============================================
spring.datasource.url=${DATABASE_URL}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect

# JPA/Hibernate
spring.jpa.show-sql=false
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.format_sql=true

# ============================================
# RABBITMQ - CONFIGURACIÓN
# ============================================
# Habilitar/deshabilitar RabbitMQ (false por defecto)
rabbitmq.enabled=${RABBITMQ_ENABLED:false}

# URL de conexión a RabbitMQ (CloudAMQP format)
# Ejemplo: amqps://user:pass@server.cloudamqp.com/vhost
spring.rabbitmq.addresses=${RABBITMQ_URL:amqp://localhost:5672}

# Nombre de la cola
rabbitmq.queue.name=${RABBITMQ_QUEUE_NAME:pdis_queue}

# Nombre del exchange
rabbitmq.exchange.name=${RABBITMQ_EXCHANGE_NAME:pdis_exchange}

# Routing key
rabbitmq.routing.key=${RABBITMQ_ROUTING_KEY:pdis.process}

# Listener configuration
spring.rabbitmq.listener.simple.auto-startup=${RABBITMQ_ENABLED:false}
spring.rabbitmq.listener.simple.acknowledge-mode=auto
spring.rabbitmq.listener.simple.prefetch=1
spring.rabbitmq.listener.simple.retry.enabled=true
spring.rabbitmq.listener.simple.retry.initial-interval=3000
spring.rabbitmq.listener.simple.retry.max-attempts=3
spring.rabbitmq.listener.simple.retry.multiplier=2.0
spring.rabbitmq.listener.simple.retry.max-interval=10000

# Template configuration
spring.rabbitmq.template.retry.enabled=true
spring.rabbitmq.template.retry.initial-interval=1000
spring.rabbitmq.template.retry.max-attempts=3

# ============================================
# DATADOG METRICS
# ============================================
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.metrics.export.datadog.enabled=${DATADOG_ENABLED:false}
management.metrics.export.datadog.api-key=${DD_API_KEY:}
management.metrics.export.datadog.application-key=${DD_APP_KEY:}

# ============================================
# EXTERNAL SERVICES
# ============================================
# OCR Service
ocr.api.url=https://api.ocr.space/parse/imageurl
ocr.api.key=${OCR_API_KEY:}

# Image Labeling Service
labeling.api.url=https://api.apilayer.com/image_labeling/url
labeling.api.key=${LABELING_API_KEY:}

# Fuentes Service (Laura's service)
services.fuentes.url=${FUENTES_URL:http://localhost:8081}
services.solicitudes.url=${SOLICITUDES_URL:http://localhost:8082}
services.agregador.url=${AGREGADOR_URL:http://localhost:8083}

# External API keys
external.ocr.apikey=${OCR_API_KEY:}
external.labeling.apikey=${LABELING_API_KEY:}

# ============================================
# LOGGING
# ============================================
logging.level.root=INFO
logging.level.ar.edu.utn.dds.k3003=DEBUG
logging.level.org.springframework.amqp=INFO
logging.level.org.springframework.amqp.rabbit=INFO