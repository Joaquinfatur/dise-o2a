# ===== CONFIGURACIÓN BÁSICA =====
server.port=${PORT:8080}
spring.application.name=procesador-pdi
server.address=0.0.0.0
# ===== BASE DE DATOS =====
# En desarrollo local usa H2 (en memoria)
# En producción (Render) usa PostgreSQL con la variable DATABASE_URL
spring.datasource.url=${DATABASE_URL:jdbc:h2:mem:testdb}
spring.datasource.username=${DB_USER:sa}
spring.datasource.password=${DB_PASSWORD:}
spring.datasource.driver-class-name=${DB_DRIVER:org.h2.Driver}

# ===== JPA/HIBERNATE =====
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=${DB_DIALECT:org.hibernate.dialect.H2Dialect}
spring.jpa.database-platform=${DB_DIALECT:org.hibernate.dialect.H2Dialect}

# ===== JACKSON - Formato JSON =====
# Convierte camelCase a snake_case automáticamente
spring.jackson.property-naming-strategy=SNAKE_CASE

# ===== DESHABILITAR H2 CONSOLE =====
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration

# ===== DATADOG (Métricas) =====
management.datadog.metrics.export.enabled=${DATADOG_ENABLED:true}
management.datadog.metrics.export.api-key=${DATADOG_API_KEY:63fc749a6e650220161320fca53054ac}
management.datadog.metrics.export.uri=https://api.datadoghq.com
management.datadog.metrics.export.step=10s

# ===== ACTUATOR (Health checks y métricas) =====
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always

# ===== APIs EXTERNAS =====
# OCR: https://ocr.space/ocrapi
external.ocr.apikey=${OCR_API_KEY:}

# Labeling: https://apilayer.com/marketplace/image_labeling-api
external.labeling.apikey=${LABELING_API_KEY:}

# ===== URLs DE OTROS SERVICIOS DEL SISTEMA =====
services.fuentes.url=${FUENTES_URL:http://localhost:8081}
services.solicitudes.url=${SOLICITUDES_URL:http://localhost:8082}
services.agregador.url=${AGREGADOR_URL:http://localhost:8083}

# ===== BOT DE TELEGRAM =====
bot.enabled=${BOT_ENABLED:false}
bot.token=${TELEGRAM_BOT_TOKEN:}
bot.username=${TELEGRAM_BOT_USERNAME:}

# ===== LOGGING =====
logging.level.root=INFO
logging.level.ar.edu.utn.dds.k3003=DEBUG
logging.level.org.springframework.web=INFO
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# ===== TIMEOUTS Y CONFIGURACIÓN HTTP =====
spring.mvc.async.request-timeout=60000
server.tomcat.connection-timeout=20000